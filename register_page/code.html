<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Register for RetiNova</title>

<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

<link href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@300;400;500;600;700&family=Noto+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>

<script id="tailwind-config">
tailwind.config = {
  theme: {
    extend: {
      colors: {
        "medical-blue": {
          DEFAULT: "#0B3C5D",
          soft: "#23557a",
          pale: "#eef4f8"
        },
        "sage": {
          DEFAULT: "#8da399",
          light: "#eaf1ee",
          dark: "#5c7068"
        },
        "off-white": "#f8f9fa",
        "surface-border": "#e2e8f0",
        "text-main": "#0f172a",
        "text-muted": "#64748b",
        "alert": "#d97706"
      },
      fontFamily: {
        "display": ["Spline Sans","sans-serif"],
        "body": ["Noto Sans","sans-serif"]
      },
      boxShadow: {
        soft: "0 10px 40px -10px rgba(11, 60, 93, 0.08)",
        glow: "0 0 20px rgba(141,163,153,0.3)"
      }
    }
  }
}
</script>

<style>
body { font-family:"Spline Sans",sans-serif; }

::-webkit-scrollbar { width:8px; }
::-webkit-scrollbar-track { background:#f8f9fa; }
::-webkit-scrollbar-thumb { background:#cbd5e1; border-radius:4px; }
::-webkit-scrollbar-thumb:hover { background:#94a3b8; }

#register-tab:checked ~ #login-form { display:none; }
#register-tab:checked ~ #register-form { display:flex; }
#login-tab:checked ~ #register-form { display:none; }
#login-tab:checked ~ #login-form { display:flex; }

.tab-label { cursor:pointer; transition:all .2s; }

#login-tab:checked ~ .tab-switcher label[for="login-tab"],
#register-tab:checked ~ .tab-switcher label[for="register-tab"] {
  background-color:#0B3C5D;
  color:white;
  box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);
}
</style>
</head>

<body class="bg-off-white text-slate-800 antialiased overflow-x-hidden selection:bg-medical-blue selection:text-white">
<div class="flex flex-col min-h-screen">

<header class="flex items-center justify-between whitespace-nowrap border-b border-surface-border px-6 py-4 lg:px-10 z-20 bg-white/80 backdrop-blur-md sticky top-0">
  <div class="flex items-center gap-3">
    <div class="size-8 text-medical-blue">
      <span class="material-symbols-outlined text-3xl">visibility</span>
    </div>
    <h2 class="text-medical-blue text-xl font-bold leading-tight tracking-tight">RetiNova</h2>
  </div>

  <div class="flex items-center gap-4">
    <div class="hidden md:flex items-center gap-2 text-xs font-medium text-text-muted bg-sage-light px-3 py-1.5 rounded-full border border-surface-border">
      <span class="w-2 h-2 rounded-full bg-sage animate-pulse"></span>
      System Operational
    </div>

    <button class="flex min-w-[84px] items-center justify-center rounded-full h-10 px-6 bg-white hover:bg-off-white text-medical-blue border border-surface-border text-sm font-bold">
      <span class="truncate">Contact Support</span>
    </button>
  </div>
</header>

<main class="flex-1 flex flex-col lg:flex-row relative">

  <div class="absolute inset-0 z-0 overflow-hidden pointer-events-none">
    <div class="absolute top-[-20%] right-[-10%] w-[800px] h-[800px] bg-medical-blue/5 rounded-full blur-[120px]"></div>
    <div class="absolute bottom-[-10%] left-[-10%] w-[600px] h-[600px] bg-sage/10 rounded-full blur-[100px]"></div>
  </div>

  <div class="layout-container flex w-full h-full z-10">
    <div class="w-full flex flex-col lg:flex-row h-full">

      <!-- LEFT HERO -->
      <div class="flex-1 flex items-center justify-center p-6 lg:p-20">
        <div class="max-w-xl w-full flex flex-col gap-8">

          <div class="space-y-6">
            <h1 class="text-medical-blue text-4xl lg:text-6xl font-black leading-tight">
              Your retina knows more than
              <span class="text-transparent bg-clip-text bg-gradient-to-r from-medical-blue to-sage">you think.</span>
            </h1>

            <p class="text-text-muted text-lg lg:text-xl font-light max-w-lg">
              RetiNova is an AI platform that converts a single retinal image into early, actionable insight on eye and systemic disease. It enables fast, non-invasive screening at clinical scale.
            </p>
          </div>

          <div class="relative w-full aspect-video rounded-2xl overflow-hidden border border-surface-border shadow-2xl shadow-medical-blue/10 group bg-slate-100">
            <div class="absolute inset-0 bg-medical-blue/80 z-10 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-500 backdrop-blur-[2px]">
              <span class="text-white font-mono text-xs tracking-widest">ANALYZING RETINAL STRUCTURE...</span>
            </div>

            <div class="w-full h-full bg-cover bg-center opacity-90 mix-blend-multiply"
              style='background-image:url("https://lh3.googleusercontent.com/aida-public/AB6AXuB4IUmN-cKD6ubDchWZ1jzo7UVNK2hWhBbMsDWZhTQ0KEDoKfhMwHNPRmTa4dsy3XxR0ijYOOb5VamQBV1dvNjIk9RbJLznkPB0ORPtSHid7ivoJymrj4uWF9IwJkfrmht0TH5mSlK6IFh5J6D1lwAt3V8Tv2V1amcNm_IH4kNTPORjAjSPoSeIJEFDp6dvkiO4eRcXdx921DxVXzJCPSohoTrwkJuFiNYnRi5IiqtcI4L3nxIKltQTgZrUrZQEizCEkmUCf4i7bnHv"); filter:grayscale(.6) hue-rotate(200deg) contrast(1.1) brightness(1.1);'>
            </div>

            <div class="absolute inset-0 bg-gradient-to-t from-white via-transparent to-transparent opacity-40"></div>
          </div>

        </div>
      </div>

      <!-- RIGHT AUTH PANEL -->
      <div class="flex-1 lg:max-w-md bg-white border-l border-surface-border flex flex-col justify-center p-8 lg:p-12 shadow-soft z-20">

        <div class="w-full max-w-sm mx-auto flex flex-col gap-6">

          <div>
            <h3 class="text-2xl font-bold text-medical-blue mb-2">Create Account</h3>
            <p class="text-text-muted text-sm">Start your journey with RetiNova.</p>
          </div>

          <input class="hidden" id="login-tab" name="auth-tab" type="radio"/>
          <input class="hidden" id="register-tab" name="auth-tab" type="radio" checked/>

          <div class="bg-slate-100 p-1 rounded-full border border-surface-border flex relative">
  <a href="../login_page/code.html" 
     class="flex-1 py-2.5 px-4 rounded-full text-sm font-bold text-text-muted hover:text-medical-blue text-center transition-all flex items-center justify-center">
    Sign In
  </a>

  <div class="flex-1 py-2.5 px-4 rounded-full text-sm font-bold bg-medical-blue text-white text-center shadow-md">
    Register
  </div>
</div>

          <!-- LOGIN FORM (unchanged) -->
          <form class="hidden flex-col gap-5" id="login-form">
            <!-- kept same -->
          </form>

          <!-- REGISTER FORM (UPDATED WITH IDs) -->
          <form class="flex flex-col gap-4" id="register-form">

            <!-- Email -->
            <label class="flex flex-col gap-1.5">
              <span class="text-xs font-semibold text-slate-700 ml-2">Email ID</span>
              <div class="relative group">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400 group-focus-within:text-medical-blue">
                  <span class="material-symbols-outlined text-lg">mail</span>
                </div>
                <input id="regEmail"
                  class="w-full bg-slate-50 border border-surface-border text-slate-900 text-sm rounded-full pl-10 pr-4 py-2.5 shadow-inner"
                  type="email" placeholder="email@example.com"/>
              </div>
            </label>

            <!-- User ID -->
            <label class="flex flex-col gap-1.5">
              <span class="text-xs font-semibold text-slate-700 ml-2">User ID</span>
              <div class="relative group">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400 group-focus-within:text-medical-blue">
                  <span class="material-symbols-outlined text-lg">badge</span>
                </div>
                <input id="regUserId"
                  class="w-full bg-slate-50 border border-surface-border text-slate-900 text-sm rounded-full pl-10 pr-4 py-2.5 shadow-inner"
                  type="text" placeholder="Choose a username / ID"/>
              </div>
            </label>

            <div class="grid grid-cols-2 gap-3">

              <!-- Password -->
              <label class="flex flex-col gap-1.5">
                <span class="text-xs font-semibold text-slate-700 ml-2">New Password</span>
                <div class="relative group">
                  <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400 group-focus-within:text-medical-blue">
                    <span class="material-symbols-outlined text-lg">lock</span>
                  </div>
                  <input id="regPass"
                    class="w-full bg-slate-50 border border-surface-border text-slate-900 text-sm rounded-full pl-10 pr-4 py-2.5 shadow-inner"
                    type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"/>
                </div>
              </label>

              <!-- Confirm -->
              <label class="flex flex-col gap-1.5">
                <span class="text-xs font-semibold text-slate-700 ml-2">Confirm Password</span>
                <div class="relative group">
                  <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400 group-focus-within:text-medical-blue">
                    <span class="material-symbols-outlined text-lg">check_circle</span>
                  </div>
                  <input id="regConfirm"
                    class="w-full bg-slate-50 border border-surface-border text-slate-900 text-sm rounded-full pl-10 pr-4 py-2.5 shadow-inner"
                    type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"/>
                </div>
              </label>

            </div>

            <!-- Button -->
            <div class="pt-2">
              <button id="registerBtn" type="button"
                class="w-full flex items-center justify-center gap-2 bg-medical-blue hover:bg-medical-blue-soft text-white font-bold py-3 px-6 rounded-full shadow-lg">
                <span>Create Account</span>
                <span class="material-symbols-outlined text-sm font-bold">person_add</span>
              </button>
            </div>

          </form>

        </div>
      </div>

    </div>
  </div>

</main>
</div>

<script>
const REGISTER_API = "https://retinova-backend-1.onrender.com/auth/register";

const emailInput   = document.getElementById("regEmail");
const userIdInput  = document.getElementById("regUserId");
const passInput    = document.getElementById("regPass");
const confirmInput = document.getElementById("regConfirm");
const registerBtn  = document.getElementById("registerBtn");

registerBtn.onclick = async () => {

  const email = emailInput.value.trim();
  const userId = userIdInput.value.trim();
  const password = passInput.value.trim();
  const confirm = confirmInput.value.trim();

  // UI validation only
  if (!email || !userId || !password || !confirm) {
    alert("Please fill all fields");
    return;
  }

  if (password !== confirm) {
    alert("Passwords do not match");
    return;
  }

  registerBtn.disabled = true;
  registerBtn.innerText = "Creating Account‚Ä¶";

  try {
    // üö® Backend does NOT store password
    const res = await fetch(REGISTER_API, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        user_id: userId,
        user_email: email
      })
    });

    const data = await res.json();
    console.log("REGISTER RESPONSE:", data);

    if (!res.ok) {
      alert(data.detail || "Registration failed");
    } else {
      // ‚≠ê Canonical identity keys
      localStorage.setItem("user_id", userId);
      localStorage.setItem("user_email", email);

      alert("Account created successfully!");
      window.location.href = "../login_page/code.html";
    }

  } catch (err) {
    console.error(err);
    alert("Server unreachable ‚Äî try again.");
  }

  registerBtn.disabled = false;
  registerBtn.innerText = "Create Account";
};
</script>